{% extends "quotes/base.html" %}

{% block content %}
{% if quote %}
    <div class="quote-box">
        <p class="quote-text">‚Äú{{ quote.text }}‚Äù</p>
        <p class="quote-meta">
            –ò—Å—Ç–æ—á–Ω–∏–∫: {{ quote.source_name }} | –ñ–∞–Ω—Ä: {{ quote.genre }}
            {% if quote.author_name %}
                | –ê–≤—Ç–æ—Ä: {{ quote.author_name }}
            {% endif %}
        </p>

        <div class="quote-actions">
            <a href="#" class="vote-button" data-id="{{ quote.id }}" data-action="like" id="like-button"
               style="color: {% if voted == 'like' %}green{% else %}black{% endif %};">
               üëç <span id="like-count">{{ quote.likes }}</span>
            </a>
            <a href="#" class="vote-button" data-id="{{ quote.id }}" data-action="dislike" id="dislike-button"
               style="color: {% if voted == 'dislike' %}red{% else %}black{% endif %};">
               üëé <span id="dislike-count">{{ quote.dislikes }}</span>
            </a>
            <span class="views">üëÅ {{ quote.views }}</span>
        </div>
    </div>
{% else %}
    <p class="no-quotes">–¶–∏—Ç–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç.</p>
{% endif %}

<script>
document.querySelectorAll(".vote-button").forEach(btn => {
    btn.addEventListener("click", function(e) {
        e.preventDefault();
        const quoteId = this.dataset.id;
        const action = this.dataset.action;

        fetch(`/vote-ajax/${quoteId}/${action}/`)
            .then(res => res.json())
            .then(data => {
                document.getElementById("like-count").innerText = data.likes;
                document.getElementById("dislike-count").innerText = data.dislikes;
                document.getElementById("like-button").style.color = data.voted === "like" ? "green" : "black";
                document.getElementById("dislike-button").style.color = data.voted === "dislike" ? "red" : "black";
            });
    });
});
</script>

<style>
.quote-box {
    margin: 0 auto;
    padding: 20px;
    border: 2px solid #ccc;
    border-radius: 12px;
    max-width: 600px;
    background: #fff;
}
.quote-text {
    font-size: 1.5em;
    font-style: italic;
    margin-bottom: 15px;
}
.quote-meta {
    font-size: 0.9em;
    color: #555;
    margin-bottom: 20px;
}
.quote-actions a {
    margin: 0 10px;
    font-size: 1.2em;
    text-decoration: none;
}
.views {
    margin-left: 15px;
    font-size: 1.1em;
    color: #666;
}
</style>
{% endblock %}
